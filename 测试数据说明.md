# SQLBot 测试数据说明文档

## 📊 数据库概览

我已经在 PostgreSQL 中创建了一个完整的 **电商业务场景** 测试数据库,用于演示 SQLBot 的智能问数功能。

### 数据库信息
- **数据库名称**: `ecommerce_demo`
- **业务场景**: 电商平台
- **数据时间范围**: 2024年1月 - 2024年12月
- **数据规模**: 
  - 用户: 10人
  - 商品: 12个
  - 订单: 20笔
  - 订单明细: 22条
  - 商品评价: 13条

---

## 📋 数据表结构

### 1. 用户表 (users)
存储用户基本信息和会员等级

| 字段 | 类型 | 说明 |
|------|------|------|
| user_id | SERIAL | 用户ID (主键) |
| username | VARCHAR(50) | 用户名 |
| email | VARCHAR(100) | 邮箱 |
| phone | VARCHAR(20) | 手机号 |
| gender | VARCHAR(10) | 性别 |
| birth_date | DATE | 出生日期 |
| user_level | VARCHAR(20) | 会员等级 (Bronze/Silver/Gold/Platinum) |
| total_spent | DECIMAL(10,2) | 累计消费金额 |
| city | VARCHAR(50) | 城市 |
| province | VARCHAR(50) | 省份 |

**示例数据**:
- 张三 (Gold会员, 北京, 累计消费 ¥15,680.50)
- 李四 (Silver会员, 上海, 累计消费 ¥8,920.30)
- 王五 (Platinum会员, 深圳, 累计消费 ¥28,500.00)

### 2. 商品分类表 (categories)
商品分类层级结构

| 字段 | 类型 | 说明 |
|------|------|------|
| category_id | SERIAL | 分类ID (主键) |
| category_name | VARCHAR(50) | 分类名称 |
| parent_category_id | INT | 父分类ID |
| description | TEXT | 描述 |

**分类结构**:
- 电子产品
  - 手机
  - 电脑
- 服装鞋帽
  - 男装
  - 女装
- 食品饮料
  - 零食

### 3. 商品表 (products)
商品详细信息

| 字段 | 类型 | 说明 |
|------|------|------|
| product_id | SERIAL | 商品ID (主键) |
| product_name | VARCHAR(200) | 商品名称 |
| category_id | INT | 分类ID (外键) |
| brand | VARCHAR(100) | 品牌 |
| price | DECIMAL(10,2) | 售价 |
| cost | DECIMAL(10,2) | 成本 |
| stock_quantity | INT | 库存数量 |
| sales_count | INT | 销售数量 |
| rating | DECIMAL(3,2) | 评分 (1-5) |
| review_count | INT | 评价数量 |
| status | VARCHAR(20) | 状态 (active/inactive) |

**热门商品**:
- iPhone 15 Pro Max 256GB (¥9,999, 销量320)
- 华为 Mate 60 Pro 512GB (¥6,999, 销量450)
- MacBook Pro 14英寸 M3 (¥14,999, 销量120)
- 三只松鼠 每日坚果 (¥89, 销量3500)

### 4. 订单表 (orders)
订单主表

| 字段 | 类型 | 说明 |
|------|------|------|
| order_id | SERIAL | 订单ID (主键) |
| order_number | VARCHAR(50) | 订单编号 |
| user_id | INT | 用户ID (外键) |
| order_date | TIMESTAMP | 下单时间 |
| total_amount | DECIMAL(10,2) | 订单总额 |
| discount_amount | DECIMAL(10,2) | 优惠金额 |
| shipping_fee | DECIMAL(10,2) | 运费 |
| final_amount | DECIMAL(10,2) | 实付金额 |
| payment_method | VARCHAR(50) | 支付方式 |
| payment_status | VARCHAR(20) | 支付状态 (pending/paid/refunded) |
| order_status | VARCHAR(20) | 订单状态 (pending/processing/shipped/delivered/cancelled) |
| shipping_city | VARCHAR(50) | 收货城市 |
| shipping_province | VARCHAR(50) | 收货省份 |

### 5. 订单明细表 (order_items)
订单商品明细

| 字段 | 类型 | 说明 |
|------|------|------|
| order_item_id | SERIAL | 明细ID (主键) |
| order_id | INT | 订单ID (外键) |
| product_id | INT | 商品ID (外键) |
| product_name | VARCHAR(200) | 商品名称 |
| quantity | INT | 购买数量 |
| unit_price | DECIMAL(10,2) | 单价 |
| subtotal | DECIMAL(10,2) | 小计 |

### 6. 商品评价表 (reviews)
用户商品评价

| 字段 | 类型 | 说明 |
|------|------|------|
| review_id | SERIAL | 评价ID (主键) |
| product_id | INT | 商品ID (外键) |
| user_id | INT | 用户ID (外键) |
| order_id | INT | 订单ID (外键) |
| rating | INT | 评分 (1-5星) |
| review_text | TEXT | 评价内容 |
| helpful_count | INT | 有用数 |

---

## 📈 预置视图

为了方便数据分析,我创建了3个常用的数据视图:

### 1. monthly_sales_summary (月度销售汇总)
```sql
SELECT * FROM monthly_sales_summary;
```
显示每月的订单数量、总收入、平均订单金额

### 2. top_selling_products (热销商品排行)
```sql
SELECT * FROM top_selling_products;
```
显示销量最高的20个商品及其收入

### 3. user_purchase_summary (用户购买汇总)
```sql
SELECT * FROM user_purchase_summary;
```
显示每个用户的订单数量、总消费、平均订单金额等

---

## 🎯 SQLBot 问数示例

添加数据源后,你可以尝试以下问题来测试 SQLBot:

### 基础查询
1. "有多少个用户?"
2. "商品总数是多少?"
3. "显示所有商品分类"
4. "列出所有品牌"

### 销售分析
5. "2024年总销售额是多少?"
6. "哪个月的销售额最高?"
7. "销量最好的5个商品是什么?"
8. "iPhone 15 Pro Max 卖了多少台?"
9. "华为手机的总销售额是多少?"

### 用户分析
10. "哪个用户消费最多?"
11. "有多少个金牌会员?"
12. "北京的用户有几个?"
13. "显示消费超过1万元的用户"

### 商品分析
14. "评分最高的商品是什么?"
15. "库存最少的商品有哪些?"
16. "电子产品类别有多少个商品?"
17. "价格超过1万元的商品有哪些?"

### 订单分析
18. "今年有多少笔订单?"
19. "平均订单金额是多少?"
20. "使用支付宝支付的订单有多少?"
21. "广东省的订单数量是多少?"

### 复杂分析
22. "每个品牌的销售额排名"
23. "每个城市的订单数量和总金额"
24. "哪些商品的评分高于4.5分?"
25. "计算每个商品的利润率"
26. "找出复购率最高的用户"

---

## 🔧 在 SQLBot 中添加数据源

### 步骤 1: 登录 SQLBot
访问: http://localhost:5173/
用户名: admin
密码: SQLBot@123456

### 步骤 2: 添加数据源
1. 进入 **数据源管理**
2. 点击 **"添加数据源"**
3. 填写以下信息:

**数据源配置**:
- **数据源名称**: 电商演示数据库
- **数据源类型**: PostgreSQL
- **主机地址**: localhost
- **端口**: 5433
- **数据库名**: ecommerce_demo
- **用户名**: root
- **密码**: Password123@pg
- **Schema**: public

### 步骤 3: 测试连接
点击 **"测试连接"** 确保配置正确

### 步骤 4: 选择表
选择以下表进行同步:
- ✅ users (用户表)
- ✅ categories (分类表)
- ✅ products (商品表)
- ✅ orders (订单表)
- ✅ order_items (订单明细表)
- ✅ reviews (评价表)
- ✅ monthly_sales_summary (月度销售汇总视图)
- ✅ top_selling_products (热销商品视图)
- ✅ user_purchase_summary (用户购买汇总视图)

### 步骤 5: 保存并同步
点击 **"保存"** 完成数据源添加

---

## 💡 提示

1. **数据真实性**: 数据模拟了真实的电商业务场景,包含完整的业务逻辑
2. **时间范围**: 订单数据覆盖2024年全年,方便测试时间相关查询
3. **数据关联**: 所有表之间都有正确的外键关联,支持复杂的关联查询
4. **中文支持**: 所有数据都使用中文,方便中文问答测试
5. **性能优化**: 已创建必要的索引,查询性能良好

---

## 🗑️ 清理数据

如果需要删除测试数据库:

```sql
docker exec -it sqlbot-postgres psql -U root -d postgres -c "DROP DATABASE ecommerce_demo;"
```

---

## 📞 需要帮助?

如果在使用过程中遇到问题,请随时告诉我!
